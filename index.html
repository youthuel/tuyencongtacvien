<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đoàn trường ĐH Kinh tế - Luật</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <style>
        /* === CSS CHUNG === */
        html, body {
            font-family: 'Be Vietnam Pro', sans-serif;
            width: 100%;
            scroll-behavior: smooth;
            overflow-x: hidden;
        }
        .glass-card { background: rgba(255, 255, 255, 0.6); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .nav-active { color: #2563eb !important; font-weight: 700; }
        .scroll-animate { opacity: 0; transform: translateY(30px) scale(0.95); transition: opacity 0.7s ease-out, transform 0.7s ease-out; }
        .scroll-animate.is-visible { opacity: 1; transform: translateY(0) scale(1); }
        .deco-shape { position: absolute; z-index: 0; animation: float 8s ease-in-out infinite; }
        @keyframes float { 0% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-20px) rotate(10deg); } 100% { transform: translateY(0px) rotate(0deg); } }
        
        main:empty::before {
            content: 'Đang tải trang...';
            display: block; text-align: center; padding: 5rem; font-size: 1.25rem; color: #64748b;
        }
        .modal { visibility: hidden; opacity: 0; transition: visibility 0s 0.3s, opacity 0.3s ease; }
        .modal.is-open { visibility: visible; opacity: 1; transition: visibility 0s, opacity 0.3s ease; }
        .modal-content { transform: scale(0.95); transition: transform 0.3s ease; }
        .modal.is-open .modal-content { transform: scale(1); }
        
        /* Header & Mobile Menu */
        #mobile-menu { visibility: hidden; transition: visibility 0.3s; }
        #mobile-menu.is-open { visibility: visible; }
        #mobile-menu-panel { transform: translateX(100%); transition: transform 0.3s ease-in-out; }
        #mobile-menu.is-open #mobile-menu-panel { transform: translateX(0); }
        #mobile-menu-backdrop { opacity: 0; transition: opacity 0.3s ease-in-out; }
        #mobile-menu.is-open #mobile-menu-backdrop { opacity: 1; }
        .header-gradient-text {
            background-image: linear-gradient(to right, #3b82f6, #22d3ee, #3b82f6);
            background-size: 200% auto;
            -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
            animation: gradient-pan 5s linear infinite;
        }
        @keyframes gradient-pan { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        /* === CSS TỪNG TRANG === */
        /* CSS cho trang TRANG CHỦ */
        .gradient-text { display: inline-block; background: linear-gradient(90deg, #38bdf8, #a78bfa, #f59e0b); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
        .cta-button { box-shadow: 0px 5px 20px rgba(59, 130, 246, 0.4); transition: all 0.3s ease-in-out; }
        .cta-button:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0px 8px 25px rgba(59, 130, 246, 0.6); }
        .activity-card img { transition: transform 0.4s ease-out; }
        .activity-card:hover img { transform: scale(1.1); }
        
        /* CSS cho trang GIỚI THIỆU */
        .activity-tab { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .activity-tab.active { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.4); color: white; }
        .stat-card { transition: all 0.3s ease-out; }
        .stat-card:hover { transform: translateY(-8px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .activity-content { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* CSS cho trang TỔ CHỨC */
        .member-card, .personnel-card { transition: all 0.3s ease-in-out; }
        .member-card:hover { transform: translateY(-8px); box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1); }
        .personnel-card:hover { transform: scale(1.05); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .modal-trigger { cursor: pointer; }

        /* CSS cho trang HOẠT ĐỘNG */
        .category-card { transition: all 0.3s ease-in-out; }
        .category-card:hover { transform: translateY(-10px) rotate(-2deg); box-shadow: 0 25px 50px -12px rgba(59, 130, 246, 0.2); }
        .swiper-container { width: 100%; padding-top: 50px; padding-bottom: 50px; }
        .swiper-slide { will-change: transform; width: 340px; height: 500px; border-radius: 1.5rem; overflow: hidden; transition: transform 0.4s ease; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
/* === CSS CHO TIMELINE - TRANG QUY TRÌNH === */
        .timeline-item { display: grid; grid-template-columns: 70px 1fr; margin-bottom: 3rem; }
        .timeline-marker { display: flex; justify-content: center; align-items: center; width: 64px; height: 64px; border-radius: 9999px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); transform: translateX(-50%); position: relative; left: -2px; z-index: 10; }
        .timeline-card-new { background-image: linear-gradient(to right, var(--tw-gradient-stops)); padding: 2.5rem; border-radius: 1.5rem; box-shadow: 0 10px 30px rgba(0,0,0,0.07); transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); }
        .timeline-item:hover .timeline-card-new { transform: translateY(-10px) scale(1.02); box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15); }
        
        /* CSS cho timeline container và card trong quy-trinh.html */
        .timeline-item-container { transition: all 0.4s ease; }
        .timeline-item-container:hover .timeline-card { transform: translateY(-8px); box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.1); }
        .timeline-item-container:hover .timeline-dot { transform: scale(1.2); }
        .background-blob { position: absolute; opacity: 0.6; filter: blur(100px); z-index: 0; }
        
        /* CSS cho FAQ Accordion */
        .faq-answer { 
            max-height: 0; 
            overflow: hidden; 
            transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out; 
            padding-top: 0;
            padding-bottom: 0;
        }
        .faq-item.open .faq-answer { 
            max-height: 300px; 
            padding-top: 1.25rem;
            padding-bottom: 1.25rem;
        }
        .faq-item.open .faq-arrow { transform: rotate(180deg); }
        .faq-question { cursor: pointer; }
        .faq-question:hover { background-color: #f8fafc; }
        
        @media (max-width: 768px) { .timeline-item { grid-template-columns: 50px 1fr; } .timeline-marker { width: 48px; height: 48px; } .timeline-marker svg { width: 1.5rem; height: 1.5rem; } .timeline-card-new { padding: 1.5rem; } }
        
        .animated-gradient-ring {
            /* Dải màu mới sống động và mượt mà hơn */
            background-image: linear-gradient(-45deg, #f857a6, #ff5858, #ffc94e, #23d5ab, #23a6d5, #f857a6);
            /* Tăng kích thước background để chứa được nhiều màu */
            background-size: 600% 600%;
            /* Animation mới chuyển động qua lại mượt mà */
            animation: gradient-pan 8s ease-in-out infinite;
        }
        @keyframes gradient-pan {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        
        .faq-question {
            cursor: pointer;
        }
        .faq-arrow {
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .faq-item.open .faq-arrow {
            transform: rotate(180deg);
        }
        .faq-answer {
            display: grid;
            grid-template-rows: 0fr; /* Mặc định ẩn câu trả lời */
            overflow: hidden;
            transition: grid-template-rows 0.5s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .faq-item.open .faq-answer {
            grid-template-rows: 1fr; /* Hiện câu trả lời với chiều cao tự động */
        }
        .faq-answer > div {
            min-height: 0;
        }

        .department-card {
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .department-card:hover {
            transform: translateY(-12px);
            box-shadow: 0 30px 40px -20px rgba(0, 0, 0, 0.15);
        }

        .card-bg-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.05;
            background-size: cover;
            transition: opacity 0.3s ease, transform 0.5s ease;
        }

        .department-card:hover .card-bg-pattern {
            opacity: 0.1;
            transform: scale(1.1);
        }

        .card-icon {
            margin-bottom: 1.5rem;
            padding: 1rem;
            border-radius: 9999px;
            background-color: rgba(255, 255, 255, 0.2);
            display: inline-flex;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .card-icon svg {
            width: 2.5rem;
            height: 2.5rem;
        }

        .card-slogan {
            font-size: 1.125rem;
            font-style: italic;
            color: rgba(255, 255, 255, 0.85);
            margin-bottom: 1.5rem;
        }

        .card-tasks {
            list-style: none;
            padding: 0;
            text-align: left;
            width: 100%;
        }

        .card-tasks li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.95);
        }

        .card-tasks li::before {
            content: '✓';
            margin-right: 0.75rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            flex-shrink: 0;
        }
        /* === CSS CHO PHẦN PHONG TRÀO HÀNH ĐỘNG MỚI === */
        .movement-card {
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border-color: transparent;
        }
        .movement-card.active {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            background-color: white;
        }
        .movement-card[data-color="blue"].active { border-color: #3b82f6; }
        .movement-card[data-color="rose"].active { border-color: #f43f5e; }
        .movement-card[data-color="teal"].active { border-color: #14b8a6; }

        .movement-content { animation: fadeIn 0.6s ease-in-out; }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(15px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

    </style>
</head>
<body class="flex flex-col min-h-screen">
    
    <header id="header" class="bg-white/90 backdrop-blur-lg sticky top-0 left-0 right-0 z-50 shadow-sm transition-all duration-300">
        <div class="container mx-auto px-6 py-2 flex justify-between items-center">
            <a href="#home" class="nav-trigger flex items-center space-x-2 z-20" data-page="home">
                <img src="pic/logo/logodt.png" alt="Logo Đoàn Trường UEL" class="h-10 w-auto">
                <span class="text-xl font-extrabold tracking-tight header-gradient-text">ĐOÀN TRƯỜNG UEL</span>
            </a>
            <nav class="hidden md:flex items-center space-x-8" id="main-nav">
                <a href="#gioithieu" class="nav-trigger nav-link text-gray-600 hover:text-blue-600 font-semibold" data-page="gioithieu">Giới thiệu</a>
                <a href="#tochuc" class="nav-trigger nav-link text-gray-600 hover:text-blue-600 font-semibold" data-page="tochuc">Tổ chức</a>
                <a href="#hoat-dong" class="nav-trigger nav-link text-gray-600 hover:text-blue-600 font-semibold" data-page="hoat-dong">Hoạt động</a>
                <a href="#quy-trinh" class="nav-trigger nav-link text-gray-600 hover:text-blue-600 font-semibold" data-page="quy-trinh">Ứng tuyển</a>
                <a href="https://www.facebook.com/youth.uel" target="_blank" class="text-gray-600 hover:text-blue-600 font-semibold">Liên hệ</a>
            </nav>
            <div class="flex items-center gap-4">
                <a href="https://forms.gle/BH22QpPCdN2LJd8d7" target="_blank" class="hidden sm:block bg-blue-600 text-white font-bold py-2.5 px-6 rounded-full hover:bg-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-blue-500/30">Đăng ký</a>
                <button id="mobile-menu-button" class="md:hidden p-2 rounded-md text-gray-600 hover:bg-gray-100 focus:outline-none z-20">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </div>
    </header>

    <main id="app-container"></main>

    <div id="mobile-menu" class="fixed inset-0 z-40 md:hidden">
        <div id="mobile-menu-backdrop" class="fixed inset-0 bg-black/60"></div>
        <div id="mobile-menu-panel" class="relative z-50 bg-white w-4/5 max-w-sm h-full ml-auto p-6 shadow-xl flex flex-col">
            <div class="flex justify-end items-center mb-8">
                 <button id="mobile-menu-close-button" class="p-2 rounded-md text-gray-600 hover:bg-gray-100">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                 </button>
            </div>
            <nav class="flex flex-col space-y-4 text-lg">
                <a href="#gioithieu" class="nav-trigger nav-link text-gray-700 hover:text-blue-600 font-semibold py-2" data-page="gioithieu">Giới thiệu</a>
                <a href="#tochuc" class="nav-trigger nav-link text-gray-700 hover:text-blue-600 font-semibold py-2" data-page="tochuc">Tổ chức</a>
                <a href="#hoat-dong" class="nav-trigger nav-link text-gray-700 hover:text-blue-600 font-semibold py-2" data-page="hoat-dong">Hoạt động</a>
                <a href="#quy-trinh" class="nav-trigger nav-link text-gray-700 hover:text-blue-600 font-semibold py-2" data-page="quy-trinh">Quy trình</a>
                <a href="https://www.facebook.com/youth.uel" target="_blank" class="nav-link text-gray-700 hover:text-blue-600 font-semibold py-2">Liên hệ</a>
            </nav>
            <a href="https://forms.gle/BH22QpPCdN2LJd8d7" target="_blank" class="w-full mt-auto text-center bg-blue-600 text-white font-bold py-3 px-6 rounded-full hover:bg-blue-700 transition-all duration-300">Đăng ký Ngay</a>
        </div>
    </div>
    
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const appContainer = document.getElementById('app-container');
        const routes = {
            'home': { path: 'pages/home.html', title: 'Tuyển Cộng Tác Viên' },
            'gioithieu': { path: 'pages/gioithieu.html', title: 'Giới Thiệu' },
            'tochuc': { path: 'pages/tochuc.html', title: 'Cơ Cấu Tổ Chức' },
            'hoat-dong': { path: 'pages/hoat-dong.html', title: 'Hoạt Động' },
            'quy-trinh': { path: 'pages/quy-trinh.html', title: 'Quy Trình Ứng Tuyển' }
        };
        let countdownInterval;

        const initializePageScripts = () => {
            if (countdownInterval) clearInterval(countdownInterval);

            // 1. SCROLL ANIMATE
            document.querySelectorAll('.scroll-animate').forEach(el => {
                new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('is-visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 }).observe(el);
            });

            // 2. MODAL HANDLERS
            const openModal = (modalId) => {
                const modal = document.querySelector(modalId);
                if (modal) modal.classList.add('is-open');
            };
            const closeModal = (modal) => {
                if (modal) modal.classList.remove('is-open');
            };

            document.querySelectorAll('.modal-trigger').forEach(trigger => {
                trigger.addEventListener('click', () => {
                    const modalId = trigger.getAttribute('data-modal-target');
                    openModal(modalId);
                });
            });

            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal || e.target.closest('.modal-close')) {
                        closeModal(modal);
                    }
                });
            });
            
            // 3. SWIPER SLIDER
            if (document.querySelector('.mySwiper')) {
                new Swiper(".mySwiper", {
                    effect: "cards", 
                    grabCursor: true, 
                    loop: false,  // Tắt loop mode để tránh warning
                    speed: 800,
                    autoplay: { 
                        delay: 3500, 
                        disableOnInteraction: false 
                    },
                    cardsEffect: { 
                        slideShadows: false,
                        perSlideRotate: 2,
                        perSlideOffset: 8
                    },
                    // Tạo hiệu ứng "virtual" loop bằng cách quay lại slide đầu tiên khi đến slide cuối
                    on: {
                        reachEnd: function() {
                            // Chờ một chút rồi quay về slide đầu tiên
                            setTimeout(() => {
                                this.slideTo(0, 800);
                            }, 1000);
                        }
                    }
                });
            }
             
            // 4. ANIMATED COUNTER
            const statsContainer = document.getElementById('stats-container');
            if (statsContainer) {
                new IntersectionObserver((entries, observer) => {
                    if (entries[0].isIntersecting) {
                        statsContainer.querySelectorAll('.stat-counter').forEach(counter => {
                            const target = +counter.getAttribute('data-target');
                            let current = 0;
                            const increment = target / 100;
                            const updateCounter = () => {
                                if (current < target) {
                                    current += increment;
                                    counter.innerText = Math.ceil(current).toLocaleString();
                                    requestAnimationFrame(updateCounter);
                                } else {
                                    counter.innerText = target.toLocaleString();
                                }
                            };
                            updateCounter();
                        });
                        observer.unobserve(statsContainer);
                    }
                }, { threshold: 0.8 }).observe(statsContainer);
            }

            // 5. ACTIVITY TABS
            const tabsContainer = document.getElementById('activity-tabs');
            if (tabsContainer) {
                const tabs = tabsContainer.querySelectorAll('.activity-tab');
                const contents = document.querySelectorAll('.activity-content');
                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const targetId = tab.getAttribute('data-target');
                        tabs.forEach(item => item.classList.remove('active', 'bg-blue-500', 'bg-rose-500', 'bg-teal-500'));
                        tab.classList.add('active', 'bg-blue-500');
                        contents.forEach(content => content.classList.toggle('hidden', content.id !== targetId));
                    });
                });
            }

            // 6. COUNTDOWN TIMER
            const countdownElement = document.getElementById('countdown');
            if (countdownElement) {
                const countdownDate = new Date("Sep 20, 2025 18:00:00").getTime();
                countdownInterval = setInterval(() => {
                    const now = new Date().getTime();
                    const distance = countdownDate - now;
                    const D = (id, val) => { const el = document.getElementById(id); if (el) el.innerText = val; };
                    D('days', Math.floor(distance / 86400000).toString().padStart(2, '0'));
                    D('hours', Math.floor((distance % 86400000) / 3600000).toString().padStart(2, '0'));
                    D('minutes', Math.floor((distance % 3600000) / 60000).toString().padStart(2, '0'));
                    D('seconds', Math.floor((distance % 60000) / 1000).toString().padStart(2, '0'));
                    if (distance < 0) {
                        clearInterval(countdownInterval);
                        countdownElement.innerHTML = "<p class='text-lg font-bold'>Sự kiện đã diễn ra!</p>";
                    }
                }, 1000);
            }
            const initMovementCards = () => {
                const container = document.getElementById('movement-cards-container');
                if (!container) return;

                const cards = container.querySelectorAll('.movement-card');
                const contents = document.querySelectorAll('.movement-content');
                const mainSection = document.getElementById('phong-trao-section');
                const originalBg = 'bg-gradient-to-br from-sky-50 to-blue-100'; // Nền mặc định

                // Lấy danh sách class nền cũ để xóa
                const bgClasses = Array.from(cards).map(c => c.dataset.bg);

                cards.forEach(card => {
                    card.addEventListener('click', () => {
                        // Xử lý active state cho card
                        cards.forEach(c => c.classList.remove('active'));
                        card.classList.add('active');

                        // Ẩn/hiện nội dung tương ứng
                        const targetId = card.dataset.content;
                        contents.forEach(content => {
                            content.classList.toggle('hidden', content.id !== targetId);
                        });

                        // Cập nhật nền cho section
                        if (mainSection) {
                            const newBg = card.dataset.bg || originalBg;
                            // Xóa tất cả các class nền có thể có
                            mainSection.classList.remove(...bgClasses);
                            // Thêm class nền mới
                            mainSection.classList.add(...newBg.split(' '));
                        }
                    });
                });
            };
            initMovementCards(); // Gọi hàm
           
            // 7. FAQ ACCORDION
            const initFAQ = () => {
                const faqItems = document.querySelectorAll('.faq-item');
                if (faqItems.length > 0) {
                    faqItems.forEach(item => {
                        const question = item.querySelector('.faq-question');
                        question.addEventListener('click', () => {
                            faqItems.forEach(otherItem => {
                                if (otherItem !== item) {
                                    otherItem.classList.remove('open');
                                }
                            });
                            item.classList.toggle('open');
                        });
                    });
                    return true;
                }
                return false;
            };

            // Try multiple times with different delays
            let faqInitialized = initFAQ();
            if (!faqInitialized) {
                setTimeout(() => {
                    faqInitialized = initFAQ();
                    if (!faqInitialized) {
                        setTimeout(() => {
                            faqInitialized = initFAQ();
                        }, 500);
                    }
                }, 100);
            }
        };

        const loadPage = async (pageKey = 'home') => {
            const route = routes[pageKey];
            if (!route) { 
                appContainer.innerHTML = `<p class="text-center p-20">Lỗi 404</p>`; 
                return; 
            }
            try {
                const response = await fetch(route.path);
                if (!response.ok) throw new Error('Network response was not ok');
                const content = await response.text();
                appContainer.innerHTML = content;
                window.scrollTo(0, 0);
                document.title = `${route.title} | Đoàn trường ĐH Kinh tế - Luật`;
                updateActiveNavLink(pageKey);
                initializePageScripts();
            } catch (error) {
                appContainer.innerHTML = `<p class="text-center p-20">Lỗi tải trang.</p>`;
            }
        };
        
        const updateActiveNavLink = (pageKey) => {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.toggle('nav-active', link.dataset.page === pageKey);
            });
        };
        
        const mobileMenu = document.getElementById('mobile-menu');
        const closeMenu = () => mobileMenu.classList.remove('is-open');

        document.body.addEventListener('click', (e) => {
            const target = e.target;
            const navTrigger = target.closest('.nav-trigger');

            if (navTrigger && navTrigger.dataset.page) {
                e.preventDefault();
                const pageKey = navTrigger.dataset.page;
                if ((location.hash.substring(1) || 'home') !== pageKey) {
                   history.pushState({ page: pageKey }, '', `#${pageKey}`);
                   loadPage(pageKey);
                }
                closeMenu();
                return;
            }
        });

        window.addEventListener('popstate', () => loadPage(location.hash.substring(1) || 'home'));
        loadPage(location.hash.substring(1) || 'home');

        const openMenu = () => mobileMenu.classList.add('is-open');
        document.getElementById('mobile-menu-button').addEventListener('click', () => mobileMenu.classList.contains('is-open') ? closeMenu() : openMenu());
        document.getElementById('mobile-menu-close-button').addEventListener('click', closeMenu);
        document.getElementById('mobile-menu-backdrop').addEventListener('click', closeMenu);
    });
    </script>
</body>
</html>